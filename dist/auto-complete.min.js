/*!*************************************************
* auto-complete.js 1.0.0
* https://github.com/angezid/auto-complete.js
* MIT licensed
* Copyright (c) 2025, angezid
**************************************************/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).autoComplete=e()}(this,(function(){"use strict";const t={create:function(t,e){const n=`([${this.preprocess(t.queryChars)}]+)`,o="(^|["+this.preprocess(t.triggerChars)+"]+)";return t.debug&&console.log(e+": RegExp trigger pattern - "+o," query pattern - "+n),new RegExp(`${o}${n}$`,"u")},preprocess:function(t){if(t&&t.length){return t.split(/(\\[pPu]\{[^}]+\}|\\[swdSWDnt]|.)/).filter((t=>t.length)).map(((t,e)=>this.noEscape(t,e)?t:this.escapeCharSet(t))).join("")}return""},noEscape:function(t,e){return 0===e&&"^"===t||t.length>4||/\\[swdSWDnt]/.test(t)},escapeCharSet:function(t){return t.replace(/[-^\]\\]/g,"\\$&")}},e={caretCoordinates:null,getText:function(t){const e=this.getSelection(t).getRangeAt(0),n=document.createRange();n.selectNodeContents(t),n.setEnd(e.startContainer,e.startOffset);let o=e.getBoundingClientRect();return 0===o.x&&0===o.y&&(o=e.startContainer.getBoundingClientRect()),this.caretCoordinates=o,n.toString()},replace:function(t,e,n){const o=this.getText(t).length;this.select(t,o-e.length,o);const r={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};document.execCommand("insertHTML",!1,n.replace(/[<>&"']/g,(t=>r[t])))},select:function(t,e,n){const o=this.getSelection(t);let r,s,i,l=0,c=0,u=0;const a=document.createNodeIterator(t,NodeFilter.SHOW_TEXT);for(;i=a.nextNode();)if(i.nodeValue){const t=u+i.nodeValue.length;if(!r&&t>e&&(r=i,l=e-u),!s&&t>=n){s=i,c=n-u;break}u=t}r&&s&&o.setBaseAndExtent(r,l,s,c)},getSelection:function(t){return t.getRootNode().getSelection()}};function n(t,e,n,o){let r=document.createElement(e);return n&&r.setAttribute("class",n),o&&(r.textContent=o),t.appendChild(r),r}const o={caretCoordinates:null,getText:function(t){const e=t.selectionStart,n=t.value.substr(0,e);return this.caretCoordinates=this.getCaretCoordinates(t,e),n},replace:function(t,e,n){const o=t.value,r=t.selectionStart,s=r-e.length;t.value=o.substr(0,s)+n+o.substr(r),t.selectionStart=t.selectionEnd=s+n.length},getCaretCoordinates:function(t,e){const o=t.getBoundingClientRect(),r=t instanceof HTMLInputElement,s=t.value,i=s.length,l=s.substring(0,e),c=window.getComputedStyle(t),u=n(document.body,"div",null,r?l.replace(/\s/g," "):l),a=n(u,"span",null,s.substr(e,i-e>50?50:i)||".");["direction","boxSizing","textAlign","textAlignLast","textTransform","textIndent","letterSpacing","wordSpacing","wordBreak","overflowX","overflowY","tabSize"].forEach((t=>{u.style[t]=c.getPropertyValue(t)}));const f={width:c.width,wordWrap:"normal",whiteSpace:"pre-wrap"};Object.assign(u.style,{position:"absolute",visibility:"hidden",top:o.top+"px",left:o.left+"px",font:c.font,padding:c.padding,border:c.border},r?{}:f);const d=parseInt(c.fontSize),g=d+d/2,h=o.top+a.offsetTop-(t.scrollHeight>t.clientHeight?t.scrollTop:0)+parseInt(c.borderTopWidth),p=o.left+a.offsetLeft-(t.scrollWidth>t.clientWidth?t.scrollLeft:0)+parseInt(c.borderLeftWidth)-1;return document.body.removeChild(u),{top:h,left:p,height:g}}},r={chars:["aàáảãạăằắẳẵặâầấẩẫậäåāą","cçćč","dđď","eèéẻẽẹêềếểễệëěēę","iìíỉĩịîïī","lł","nñňń","oòóỏõọôồốổỗộơởỡớờợöøōő","rř","sšśșş","tťțţ","uùúủũụưừứửữựûüůūű","yýỳỷỹỵÿ","zžżź"],obj:{},init:function(){this.chars.forEach((t=>{const e=t[0],n=t[0].toUpperCase();for(let o=1;o<t.length;o++)this.obj[t[o]]=e,this.obj[t[o].toUpperCase()]=n}))},replace:function(t){for(let e=0;e<t.length;e++)if(this.obj[t[e]])return t.split("").map((t=>this.obj[t]||t)).join("");return t}};return function(s,i){this.ctx=s,this.options=i,this.newElement=function(t){j(),x(t)},this.destroy=function(t){j(),O(document,"click",C),O(window,"resize",S),O(window,"load",w),d&&document.body.removeChild(d)},this.createIndexes=function(t){return v(t)};const l="auto-complete",c="auto-complete.js";let u,a,f,d,g,h,p=0,m=0;const y=Object.assign({},{queryChars:"\\d\\p{L}_-",triggerChars:"\\s!\"#$%&'()*+,-./:;<=>?@[]\\^`{|}~",listTag:"ul",listItemTag:"li",listClass:l+"-list",listItemClass:l+"-item",listOffsetX:5,listOffsetY:5,debounce:1,threshold:1,maxResults:100,debug:!1},this.options);function x(t){const e="string"==typeof t?document.querySelector(t):t;return e&&(h=!(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement),k(e,"input",T),k(e,"blur",S),k(e,"keydown",E)),e}function b(t){!function(t){let n,r;if(!t||!(n=t.getAttribute("data-json")))return;const s=JSON.parse(n.replaceAll("&#34;",'"'));r=s.text,L(y.select)&&(r=y.select(s));h?e.replace(u,s.query,r):o.replace(u,s.query,r);S()}(t.target.closest(y.listItemTag))}function w(){setTimeout((function(){document.querySelectorAll(g).forEach((t=>{t.style.display="none"}))}),20)}function C(t){d.contains(t.target)||S()}function T(){!function(){let t}(function(){f=null;const t=function(){const t=h?e:o,n=t.getText(u);f=t.caretCoordinates;const r=a.exec(n);if(r){const t=r.groups;let e,n;return t&&(n=t.query)?e=t.trigger:(n=r[2])&&(e=r[1]),$(`${c}: trigger = '${e}' query = '${n}`),{trigger:e,query:n}}const s=n.length;return $(c+": No match. ",s>20?" ... "+n.slice(s-20):n),null}();if(t&&t.query.length>=y.threshold&&f){let e=function(t){const e=[],n=A(t.query),o=y.startsWith,r=y.suggestions;let s=0;if(Array.isArray(r))i(r,0,r.length);else{const o=r.indexes,s=function(t,e){for(let n=Math.min(y.threshold+1,t.length);n>=1;n--){const o=e[q(t,n)];if(o)return o}return null}(n,o);if(!s)return $(c+": Array of indexes is undefined for ",t.query),e;s.forEach((t=>{i(r.array,t[0],t[1])}))}function i(r,i,l){for(;i<l;i++){const l=r[i],c=A(l).indexOf(n);if(o?0===c:c>=0){if(++s>=y.maxResults)break;e.push({text:l,query:t.query,trigger:t.trigger,startIndex:c})}}}return $(c+": Suggestion count =",e.length),e}(t);if(L(y.filter)&&e.length&&(e=y.filter(e)||e),p=e.length,p)return!y.startsWith&&y.sort&&function(t,e){e=A(e,!0),t.sort(((t,e)=>t.startIndex-e.startIndex));const n=t.findIndex((t=>0===t.startIndex&&e===A(t.value,!0)));if(n>0){const e=t[0];t[0]=t[n],t[n]=e}}(e,t.query),void function(t){const e=L(y.listItem);d.innerHTML="",t.forEach(((t,o)=>{const r=t.text,s=n(d,y.listItemTag,y.listItemClass,r);if(y.highlight){const e=t.startIndex,o=e+t.query.length;s.textContent=e>0?r.substr(0,e):"",n(s,"mark",null,r.substring(e,o)),o<r.length&&s.appendChild(document.createTextNode(r.substr(o)))}e&&y.listItem(s,t);const i=JSON.stringify(t).replaceAll('"',"&#34;");s.setAttribute("data-json",i)}));const o=function(){d.style.display="block";const t=d.getBoundingClientRect(),e=y.listOffsetX,n=y.listOffsetY,o=window.pageYOffset,r=window.pageXOffset,s=r+window.innerWidth-20,i=o+window.innerHeight-20;let l=f.top+f.height+o,c=f.left+r;l+t.height>i?l=l-t.height-f.height-n:l+=n;c+t.width>s?c=c-t.width-e:c+=e;return{top:l,left:c}}();d.style.top=o.top+"px",d.style.left=o.left+"px",d.scrollTop=0,m=-1}(e)}S()}(),y.debounce)}function S(){d.innerHTML="",d.style.display="none"}function E(t){const e=t.key;if("Escape"!==e){if("ArrowUp"===e)t.preventDefault(t),m=m<=0?p-1:m-1,I();else if("ArrowDown"===e)t.preventDefault(t),m=m>=p-1?0:m+1,I();else if("Enter"===e||"Tab"===e){const e=document.querySelector(`${g} > ${y.listItemTag}.selected`);e&&(t.preventDefault(t),e.click())}}else S()}function I(){const t=document.querySelectorAll(`${g} > ${y.listItemTag}`);t.forEach(((t,e)=>{t.classList.toggle("selected",e===m)}));const e=t[m];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}function v(t){return new Promise((function(e,n){(t=t.slice()).sort();let o=y.threshold;const r={},s=Math.max(o+1,4);for(;o<s;o++){let e,n=-1;for(;++n<t.length&&!(e=q(t[n],o)););t.forEach((function(t,s){var l=q(t,o);l&&l!==e&&(r[e]=i(r[e],n,s),n=s,e=l)})),r[e]=i(r[e],n,t.length)}function i(t,e,n){return t||(t=[]),t.unshift([e,n]),t}e({array:t,indexes:r})}))}function q(t,e){return t.length<e?null:A(t.substr(0,e))}function A(t,e){return t?(t=y.caseSensitive?t:t.toLowerCase(),e?t:r.replace(t)):""}function L(t){return"function"==typeof t}function $(t){y.debug&&console.log(Array.from(arguments).join(" "))}function j(){u&&(O(u,"input",T),O(u,"blur",S),O(u,"keydown",E))}function k(t,e,n){t.addEventListener(e,n)}function O(t,e,n){t.removeEventListener(e,n)}return u=x(this.ctx),u&&(d=n(document.body,y.listTag,y.listClass),k(d,"mousedown",(t=>t.preventDefault())),k(d,"click",b),k(window,"load",w),k(window,"resize",S),k(document,"click",C),r.init(),g=`${y.listTag}.${y.listClass}`,a=y.regex instanceof RegExp?y.regex:t.create(y,c),$(c+": RegExp - /"+a.source+"/"+a.flags),y.optimize&&y.startsWith&&v(y.suggestions).then((t=>{y.suggestions=t}))),this}}));
