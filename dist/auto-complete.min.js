/*!*******************************************
* auto-complete.js 1.0.0
* https://github.com/angezid/auto-complete.js
* MIT licensed
* Copyright (c) 2025, angezid
*********************************************/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).autoComplete=e()}(this,(function(){"use strict";function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.apply(null,arguments)}var e={create:function(t,e){var n=this.preprocess(t.queryChars),r="([".concat(n,"]+)"),o="(^|["+this.preprocess(t.triggerChars)+"]+)";return t.debug&&console.log(e+": RegExp trigger pattern - "+o," query pattern - "+r),new RegExp("".concat(o).concat(r,"$"),"u")},preprocess:function(t){var e=this;return t&&t.length?t.split(/(\\[pPu]\{[^}]+\}|\\[swdSWDnt]|.)/).filter((function(t){return t.length})).map((function(t,n){return e.noEscape(t,n)?t:e.escapeCharSet(t)})).join(""):""},noEscape:function(t,e){return 0===e&&"^"===t||t.length>4||/\\[swdSWDnt]/.test(t)},escapeCharSet:function(t){return t.replace(/[-^\]\\]/g,"\\$&")}},n={caretCoordinates:null,getText:function(t,e){var n,r=this.getSelection(t),o="";if(!r.rangeCount||(n=r.getRangeAt(0)).startContainer===t)return this.caretCoordinates=t.getBoundingClientRect(),t.textContent;var i=n.startContainer,s=n.startOffset;if(e||"plaintext-only"===t.contentEditable&&!this.isFirefox()){var a=document.createRange();if(a.selectNodeContents(t),a.setEnd(i,s),o=a.toString(),e)return o}else{var u=r.anchorNode,c=r.anchorOffset,l=r.focusNode,f=r.focusOffset;r.setBaseAndExtent(t,0,i,s),o=r.toString(),r.setBaseAndExtent(u,c,l,f)}var d=n.getBoundingClientRect();return 0===d.x&&0===d.y&&(d=i.getBoundingClientRect()),this.caretCoordinates=d,o},replace:function(t,e,n){var r=this.getText(t,!0).length,o="true"===t.contentEditable||!this.isFirefox();if(o){var i={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};n=n.replace(/[<>&"']/g,(function(t){return i[t]}))}this.select(t,r-e.length,r),document.execCommand(o?"insertHTML":"insertText",!1,n)},select:function(t,e,n){for(var r,o,i,s=0,a=0,u=0,c=document.createNodeIterator(t,NodeFilter.SHOW_TEXT);i=c.nextNode();){var l=u+i.nodeValue.length;if(!r&&l>e&&(r=i,s=e-u),!o&&l>=n){o=i,a=n-u;break}u=l}r&&o&&this.getSelection(t).setBaseAndExtent(r,s,o,a)},getSelection:function(t){return t.getRootNode().getSelection()},isFirefox:function(){return/firefox/i.test(navigator.userAgent)}};function r(t,e,n,r){var o=document.createElement(e);if(n)for(var i in n)o.setAttribute(i,n[i]);return r&&(o.textContent=r),t.appendChild(o),o}var o={caretCoordinates:null,getText:function(t){var e=t.selectionStart,n=t.value.substr(0,e);return this.caretCoordinates=this.getCaretCoordinates(t,e),n},replace:function(t,e,n){var r=t.value,o=t.selectionStart,i=o-e.length;t.value=r.substr(0,i)+n+r.substr(o),t.selectionStart=t.selectionEnd=i+n.length},getCaretCoordinates:function(e,n){var o=e.getBoundingClientRect(),i=e instanceof HTMLInputElement,s=e.value,a=s.substring(0,n),u=window.getComputedStyle(e),c=r(document.body,"div",null,i?a.replace(/\s/g," "):a),l=r(c,"span",null,s.substring(n)||".");["direction","boxSizing","textAlign","textAlignLast","textTransform","textIndent","letterSpacing","wordSpacing","wordBreak","overflowX","overflowY","tabSize"].forEach((function(t){c.style[t]=u[t]}));var f={width:u.width,height:u.height,wordWrap:"normal",whiteSpace:"pre-wrap"};t(c.style,{position:"absolute",visibility:"hidden",top:o.top+"px",left:o.left+"px",font:u.font,padding:u.padding,border:u.border},i?{}:f);var d=parseInt(u.fontSize),g=d+d/2,h=o.top+l.offsetTop-(e.scrollHeight>e.clientHeight?e.scrollTop:0)+parseInt(u.borderTopWidth),p=o.left+l.offsetLeft-(e.scrollWidth>e.clientWidth?e.scrollLeft:0)+parseInt(u.borderLeftWidth)-1;return document.body.removeChild(c),{top:h,left:p,height:g}}},i={chars:["aàáảãạăằắẳẵặâầấẩẫậäåāą","cçćč","dđď","eèéẻẽẹêềếểễệëěēę","iìíỉĩịîïī","lł","nñňń","oòóỏõọôồốổỗộơởỡớờợöøōő","rř","sšśșş","tťțţ","uùúủũụưừứửữựûüůūű","yýỳỷỹỵÿ","zžżź"],obj:{},init:function(){var t=this;this.chars.forEach((function(e){for(var n=e[0],r=e[0].toUpperCase(),o=1;o<e.length;o++)t.obj[e[o]]=n,t.obj[e[o].toUpperCase()]=r}))},replace:function(t){for(var e=this,n=0;n<t.length;n++)if(this.obj[t[n]])return t.split("").map((function(t){return e.obj[t]||t})).join("");return t}};return function(s,a){this.newElement=function(t){M(),T(t)},this.destroy=function(){M(),D(document,"click",A),D(window,"resize",O),D(window,"load",I),f&&document.body.removeChild(f)},this.createIndexes=function(t){return R(t)};var u,c,l,f,d,g,h,p,v,y,m="auto-complete",x="auto-complete.js",b=0,C=0,w=t({},{queryChars:"\\d\\p{L}_-",triggerChars:"\\s!\"#$%&'()*+,-./:;<=>?@[]\\^`{|}~",listTag:"ul",listItemTag:"li",listClass:m+"-list",listItemClass:m+"-item",listOffsetX:5,listOffsetY:5,debounce:1,threshold:1,maxResults:100,debug:!1},a),E=(p=function(){l=null;var t=function(){var t=g?n:o,e=t.getText(u);l=t.caretCoordinates;var r=c.exec(e);if(r){var i,s,a=r.groups;return a&&(s=a.query)?i=a.trigger:(s=r[2])&&(i=r[1]),H("trigger = '".concat(i,"' query = '").concat(s,"'")),{trigger:i,query:s}}var f=e.length;return H("No match. ",(f>20?" ... "+e.slice(f-20):e).replace(/\r?\n|\r/g," ")),null}();if(t&&t.query.length>=w.threshold&&l){var e=function(t){var e=[],n=N(t.query),r=w.startsWith,o=w.suggestions,i=0;function s(t,e){var r=t.indexes,o=function(t,e){for(var n=Math.min(w.threshold+1,t.length);n>=1;n--){var r=e[k(t,n)];if(r)return r}return null}(n,r);o?o.forEach((function(n,r){a(t.array,n[0],n[1],e,r)})):H("Array of indexes is undefined for ",t.query)}function a(o,s,a,u,c){for(;s<a;s++){var l=o[s],f=N(l).indexOf(n);if(r?0===f:f>=0){if(++i>=w.maxResults)break;e.push({text:l,query:t.query,trigger:t.trigger,startIndex:f,arrayIndex:u,sortIndex:c})}}}return Array.isArray(o)?W(o)?a(o,0,o.length,0,0):W(o[0])?o.forEach((function(t,e){a(t,0,t.length,e,0)})):o.forEach((function(t,e){s(t,e)})):s(o,0),H("Suggestion count =",e.length),e}(t);if(B(w.filter)&&e.length&&(e=w.filter(e)||e),b=e.length)return!w.startsWith&&w.sort&&function(t,e){e=N(e,!0),t.sort((function(t,e){return t.startIndex-e.startIndex}));var n=t.findIndex((function(t){return 0===t.startIndex&&e===N(t.value,!0)}));if(n>0){var r=t[0];t[0]=t[n],t[n]=r}}(e,t.query),void function(t){var e=B(w.listItem);f.innerHTML="",t.forEach((function(t){var n=t.text,o=r(f,w.listItemTag,{class:w.listItemClass},n);if(w.highlight){var i=t.startIndex,s=i+t.query.length;o.textContent=i>0?n.substr(0,i):"",r(o,"mark",null,n.substring(i,s)),s<n.length&&o.appendChild(document.createTextNode(n.substr(s)))}e&&w.listItem(o,t);var a=JSON.stringify(t).replace(/"/g,"&#34;");o.setAttribute("data-json",a)}));var n=function(){f.style.display="block";var t=f.getBoundingClientRect(),e=w.listOffsetX,n=w.listOffsetY,r=window.pageYOffset,o=window.pageXOffset,i=o+window.innerWidth-20,s=r+window.innerHeight-20,a=l.top+l.height+r,u=l.left+o;return a+t.height>s?a=a-t.height-l.height-n:a+=n,u+t.width>i?u=u-t.width-e:u+=e,{top:a,left:u}}();f.style.top=n.top+"px",f.style.left=n.left+"px",f.scrollTop=0,C=-1,B(w.open)&&w.open(f)}(e)}O()},v=w.debounce,function(){clearTimeout(y),y=setTimeout((function(){p()}),v)});function T(t){var e="string"==typeof t?document.querySelector(t):t;e&&(g=!(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement),z(e,"input",q),z(e,"blur",O),z(e,"keydown",L),u=e)}function S(t){!function(t){var e,r;if(h=!0,!t||!(e=t.getAttribute("data-json")))return;var i=JSON.parse(e.replace(/&#34;/g,'"'));r=i.text,B(w.select)&&(r=w.select(i));if(!r)return void O();g?n.replace(u,i.query,r):o.replace(u,i.query,r);var s=w.event;s&&(s instanceof KeyboardEvent||s instanceof InputEvent)&&u.dispatchEvent(s);O()}(t.target.closest(w.listItemTag))}function I(){setTimeout((function(){document.querySelectorAll(d).forEach((function(t){t.style.display="none"}))}),20)}function A(t){f.contains(t.target)||O()}function q(t){!h&&/^(?:insertText|deleteContent($|B))/.test(t.inputType)?E():(h=!1,O())}function O(){f.innerHTML="",f.style.display="none"}function L(t){var e=t.key;if("ArrowUp"===e)return t.preventDefault(),C=C<=0?b-1:C-1,void j();if("ArrowDown"===e)return t.preventDefault(),C=C>=b-1?0:C+1,void j();if("Enter"===e||"Tab"===e){var n=f.querySelector(".selected");if(n)return t.preventDefault(),void n.click()}O()}function j(){var t=document.querySelectorAll("".concat(d," > ").concat(w.listItemTag));t.forEach((function(t,e){t.classList.toggle("selected",e===C)}));var e=t[C];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}function R(t){return new Promise((function(e,n){if(W(t))e(o(t));else if(W(t[0])){var r=[];t.forEach((function(t){r.push(o(t))})),e(r)}else n("Must be an array of strings or an array of arrays of strings");function o(t){(t=t.slice()).sort();for(var e=w.threshold,n={},r=Math.max(e+1,4),o=function(){for(var r,o=-1;++o<t.length&&!(r=k(t[o],e)););t.forEach((function(t,s){var a=k(t,e);a&&a!==r&&(n[r]=i(n[r],o,s),o=s,r=a)})),n[r]=i(n[r],o,t.length)};e<r;e++)o();function i(t,e,n){return t||(t=[]),t.unshift([e,n]),t}return{array:t,indexes:n}}}))}function k(t,e){return t.length<e?null:N(t.substr(0,e))}function W(t){return Array.isArray(t)&&t.length&&"string"==typeof t[0]}function N(t,e){return t?(t=w.caseSensitive?t:t.toLowerCase(),e?t:i.replace(t)):""}function B(t){return"function"==typeof t}function H(){w.debug&&console.log(x+": "+Array.from(arguments).join(" "))}function M(){u&&(D(u,"input",q),D(u,"blur",O),D(u,"keydown",L))}function z(t,e,n){t.addEventListener(e,n)}function D(t,e,n){t.removeEventListener(e,n)}T(s),u&&(z(f=r(document.body,w.listTag,{class:w.listClass}),"mousedown",(function(t){return t.preventDefault()})),z(f,"click",S),z(window,"load",I),z(window,"resize",O),z(document,"click",A),i.init(),d="".concat(w.listTag,".").concat(w.listClass),H("RegExp - /"+(c=w.regex instanceof RegExp?w.regex:e.create(w,x)).source+"/"+c.flags),w.optimize&&w.startsWith&&R(w.suggestions).then((function(t){w.suggestions=t})).catch((function(t){H(""+t)})))}}));
