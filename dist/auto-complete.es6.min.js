/*!*******************************************
* auto-complete.js 1.0.0
* https://github.com/angezid/auto-complete.js
* MIT licensed
* Copyright (c) 2025, angezid
*********************************************/
const t={create:function(t,e){const n=`([${this.preprocess(t.queryChars)}]+)`,o="(^|["+this.preprocess(t.triggerChars)+"]+)";return t.debug&&console.log(e+": RegExp trigger pattern - "+o," query pattern - "+n),new RegExp(`${o}${n}$`,"u")},preprocess:function(t){if(t&&t.length){return t.split(/(\\[pPu]\{[^}]+\}|\\[swdSWDnt]|.)/).filter((t=>t.length)).map(((t,e)=>this.noEscape(t,e)?t:this.escapeCharSet(t))).join("")}return""},noEscape:function(t,e){return 0===e&&"^"===t||t.length>4||/\\[swdSWDnt]/.test(t)},escapeCharSet:function(t){return t.replace(/[-^\]\\]/g,"\\$&")}},e={caretCoordinates:null,getText:function(t,e){const n=this.getSelection(t);let o,r="";if(!n.rangeCount||(o=n.getRangeAt(0)).startContainer===t)return this.caretCoordinates=t.getBoundingClientRect(),t.textContent;const i=o.startContainer,s=o.startOffset;if(e||"plaintext-only"===t.contentEditable&&!this.isFireFox){const n=document.createRange();if(n.selectNodeContents(t),n.setEnd(i,s),r=n.toString(),e)return r}else n.setBaseAndExtent(t,0,i,s),r=n.toString(),n.collapse(i,s);let c=o.getBoundingClientRect();return 0===c.x&&0===c.y&&(c=i.getBoundingClientRect()),this.caretCoordinates=c,r},replace:function(t,e,n){const o=this.getText(t,!0).length,r="true"===t.contentEditable||!this.isFireFox;if(r){const t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};n=n.replace(/[<>&"']/g,(e=>t[e]))}this.select(t,o-e.length,o),document.execCommand(r?"insertHTML":"insertText",!1,n)},select:function(t,e,n){let o,r,i,s=0,c=0,l=0;const a=document.createNodeIterator(t,NodeFilter.SHOW_TEXT);for(;i=a.nextNode();){const t=l+i.nodeValue.length;if(!o&&t>e&&(o=i,s=e-l),!r&&t>=n){r=i,c=n-l;break}l=t}o&&r&&this.getSelection(t).setBaseAndExtent(o,s,r,c)},getSelection:function(t){return t.getRootNode().getSelection()},isFireFox:function(){return/firefox/i.test(navigator.userAgent)}};function n(t,e,n,o){let r=document.createElement(e);if(n)for(const t in n)r.setAttribute(t,n[t]);return o&&(r.textContent=o),t.appendChild(r),r}const o={caretCoordinates:null,getText:function(t){const e=t.selectionStart,n=t.value.substr(0,e);return this.caretCoordinates=this.getCaretCoordinates(t,e),n},replace:function(t,e,n){const o=t.value,r=t.selectionStart,i=r-e.length;t.value=o.substr(0,i)+n+o.substr(r),t.selectionStart=t.selectionEnd=i+n.length},getCaretCoordinates:function(t,e){const o=t.getBoundingClientRect(),r=t instanceof HTMLInputElement,i=t.value,s=i.substring(0,e),c=window.getComputedStyle(t),l=n(document.body,"div",null,r?s.replace(/\s/g," "):s),a=n(l,"span",null,i.substring(e)||".");["direction","boxSizing","textAlign","textAlignLast","textTransform","textIndent","letterSpacing","wordSpacing","wordBreak","overflowX","overflowY","tabSize"].forEach((t=>{l.style[t]=c[t]}));const u={width:c.width,height:c.height,wordWrap:"normal",whiteSpace:"pre-wrap"};Object.assign(l.style,{position:"absolute",visibility:"hidden",top:o.top+"px",left:o.left+"px",font:c.font,padding:c.padding,border:c.border},r?{}:u);const f=parseInt(c.fontSize),g=f+f/2,d=o.top+a.offsetTop-(t.scrollHeight>t.clientHeight?t.scrollTop:0)+parseInt(c.borderTopWidth),h=o.left+a.offsetLeft-(t.scrollWidth>t.clientWidth?t.scrollLeft:0)+parseInt(c.borderLeftWidth)-1;return document.body.removeChild(l),{top:d,left:h,height:g}}},r={chars:["aàáảãạăằắẳẵặâầấẩẫậäåāą","cçćč","dđď","eèéẻẽẹêềếểễệëěēę","iìíỉĩịîïī","lł","nñňń","oòóỏõọôồốổỗộơởỡớờợöøōő","rř","sšśșş","tťțţ","uùúủũụưừứửữựûüůūű","yýỳỷỹỵÿ","zžżź"],obj:{},init:function(){this.chars.forEach((t=>{const e=t[0],n=t[0].toUpperCase();for(let o=1;o<t.length;o++)this.obj[t[o]]=e,this.obj[t[o].toUpperCase()]=n}))},replace:function(t){for(let e=0;e<t.length;e++)if(this.obj[t[e]])return t.split("").map((t=>this.obj[t]||t)).join("");return t}};function i(i,s){this.newElement=function(t){$(),C(t)},this.destroy=function(){$(),H(document,"click",T),H(window,"resize",S),H(window,"load",E),g&&document.body.removeChild(g)},this.createIndexes=function(t){return A(t)};const c="auto-complete",l="auto-complete.js";let a,u,f,g,d,h,p,y=0,x=0;const m=Object.assign({},{queryChars:"\\d\\p{L}_-",triggerChars:"\\s!\"#$%&'()*+,-./:;<=>?@[]\\^`{|}~",listTag:"ul",listItemTag:"li",listClass:c+"-list",listItemClass:c+"-item",listOffsetX:5,listOffsetY:5,debounce:1,threshold:1,maxResults:100,debug:!1},s),b=function(t,e){let n;return function(){clearTimeout(n),n=setTimeout((()=>{t()}),e)}}((function(){f=null;const t=function(){const t=h?e:o,n=t.getText(a);f=t.caretCoordinates;const r=u.exec(n);if(r){const t=r.groups;let e,n;return t&&(n=t.query)?e=t.trigger:(n=r[2])&&(e=r[1]),O(`trigger = '${e}' query = '${n}'`),{trigger:e,query:n}}const i=n.length;return O("No match. ",(i>20?" ... "+n.slice(i-20):n).replace(/\r?\n|\r/g," ")),null}();if(t&&t.query.length>=m.threshold&&f){let e=function(t){const e=[],n=j(t.query),o=m.startsWith,r=m.suggestions;let i=0;Array.isArray(r)?R(r)?c(r,0,r.length,0,0):R(r[0])?r.forEach(((t,e)=>{c(t,0,t.length,e,0)})):r.forEach(((t,e)=>{s(t,e)})):s(r,0);function s(t,e){const o=t.indexes,r=function(t,e){for(let n=Math.min(m.threshold+1,t.length);n>=1;n--){const o=e[L(t,n)];if(o)return o}return null}(n,o);r?r.forEach(((n,o)=>{c(t.array,n[0],n[1],e,o)})):O("Array of indexes is undefined for ",t.query)}function c(r,s,c,l,a){for(;s<c;s++){const c=r[s],u=j(c).indexOf(n);if(o?0===u:u>=0){if(++i>=m.maxResults)break;e.push({text:c,query:t.query,trigger:t.trigger,startIndex:u,arrayIndex:l,sortIndex:a})}}}return O("Suggestion count =",e.length),e}(t);if(k(m.filter)&&e.length&&(e=m.filter(e)||e),y=e.length,y)return!m.startsWith&&m.sort&&function(t,e){e=j(e,!0),t.sort(((t,e)=>t.startIndex-e.startIndex));const n=t.findIndex((t=>0===t.startIndex&&e===j(t.value,!0)));if(n>0){const e=t[0];t[0]=t[n],t[n]=e}}(e,t.query),void function(t){const e=k(m.listItem);g.innerHTML="",t.forEach((t=>{const o=t.text,r=n(g,m.listItemTag,{class:m.listItemClass},o);if(m.highlight){const e=t.startIndex,i=e+t.query.length;r.textContent=e>0?o.substr(0,e):"",n(r,"mark",null,o.substring(e,i)),i<o.length&&r.appendChild(document.createTextNode(o.substr(i)))}e&&m.listItem(r,t);const i=JSON.stringify(t).replace(/"/g,"&#34;");r.setAttribute("data-json",i)}));const o=function(){g.style.display="block";const t=g.getBoundingClientRect(),e=m.listOffsetX,n=m.listOffsetY,o=window.pageYOffset,r=window.pageXOffset,i=r+window.innerWidth-20,s=o+window.innerHeight-20;let c=f.top+f.height+o,l=f.left+r;c+t.height>s?c=c-t.height-f.height-n:c+=n;l+t.width>i?l=l-t.width-e:l+=e;return{top:c,left:l}}();g.style.top=o.top+"px",g.style.left=o.left+"px",g.scrollTop=0,x=-1,k(m.open)&&m.open(g)}(e)}S()}),m.debounce);function C(t){const e="string"==typeof t?document.querySelector(t):t;e&&(h=!(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement),W(e,"input",v),W(e,"blur",S),W(e,"keydown",I),a=e)}function w(t){!function(t){let n,r;if(p=!0,!t||!(n=t.getAttribute("data-json")))return;const i=JSON.parse(n.replace(/&#34;/g,'"'));r=i.text,k(m.select)&&(r=m.select(i));if(!r)return void S();h?e.replace(a,i.query,r):o.replace(a,i.query,r);const s=m.event;s&&(s instanceof KeyboardEvent||s instanceof InputEvent)&&a.dispatchEvent(s);S()}(t.target.closest(m.listItemTag))}function E(){setTimeout((()=>{document.querySelectorAll(d).forEach((t=>{t.style.display="none"}))}),20)}function T(t){g.contains(t.target)||S()}function v(t){!p&&/^(?:insertText|deleteContent($|B))/.test(t.inputType)?b():(p=!1,S())}function S(){g.innerHTML="",g.style.display="none"}function I(t){const e=t.key;if("ArrowUp"===e)return t.preventDefault(),x=x<=0?y-1:x-1,void q();if("ArrowDown"===e)return t.preventDefault(),x=x>=y-1?0:x+1,void q();if("Enter"===e||"Tab"===e){const e=g.querySelector(".selected");if(e)return t.preventDefault(),void e.click()}S()}function q(){const t=document.querySelectorAll(`${d} > ${m.listItemTag}`);t.forEach(((t,e)=>{t.classList.toggle("selected",e===x)}));const e=t[x];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}function A(t){return new Promise(((e,n)=>{if(R(t))e(o(t));else if(R(t[0])){const n=[];t.forEach((t=>{n.push(o(t))})),e(n)}else n("Must be an array of strings or an array of arrays of strings");function o(t){(t=t.slice()).sort();let e=m.threshold;const n={},o=Math.max(e+1,4);for(;e<o;e++){let o,i=-1;for(;++i<t.length&&!(o=L(t[i],e)););t.forEach(((t,s)=>{const c=L(t,e);c&&c!==o&&(n[o]=r(n[o],i,s),i=s,o=c)})),n[o]=r(n[o],i,t.length)}function r(t,e,n){return t||(t=[]),t.unshift([e,n]),t}return{array:t,indexes:n}}}))}function L(t,e){return t.length<e?null:j(t.substr(0,e))}function R(t){return Array.isArray(t)&&t.length&&"string"==typeof t[0]}function j(t,e){return t?(t=m.caseSensitive?t:t.toLowerCase(),e?t:r.replace(t)):""}function k(t){return"function"==typeof t}function O(){m.debug&&console.log(l+": "+Array.from(arguments).join(" "))}function $(){a&&(H(a,"input",v),H(a,"blur",S),H(a,"keydown",I))}function W(t,e,n){t.addEventListener(e,n)}function H(t,e,n){t.removeEventListener(e,n)}C(i),a&&(g=n(document.body,m.listTag,{class:m.listClass}),W(g,"mousedown",(t=>t.preventDefault())),W(g,"click",w),W(window,"load",E),W(window,"resize",S),W(document,"click",T),r.init(),d=`${m.listTag}.${m.listClass}`,u=m.regex instanceof RegExp?m.regex:t.create(m,l),O("RegExp - /"+u.source+"/"+u.flags),m.optimize&&m.startsWith&&A(m.suggestions).then((t=>{m.suggestions=t})).catch((t=>{O(""+t)})))}export{i as default};
